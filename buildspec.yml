version: 0.2

phases:
  install:
    commands:
      - yarn workspace web install
  pre_build:
    commands:
      - yarn workspace web test
  build:
    commands:
      - yarn workspace web build
  post_build:
    commands:
      - cd packages/web/build
      - export BUCKET=croton-web-dev
      - aws s3 rm s3://$BUCKET --recursive
      - aws s3 cp . s3://$BUCKET --recursive
      # - aws s3 cp index.html s3://$WEBSITEBUCKET/$SUB_NAME/index.html --cache-control no-cache
      # - aws s3 cp . s3://$WEBSITEBUCKET/$SUB_NAME --exclude "index.html" --recursive
      # - aws s3 cp ../../DeployInfo/env-$SUB_NAME.html s3://$WEBSITEBUCKET/$SUB_NAME/env.html --cache-control no-cache